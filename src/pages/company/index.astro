---
import MainLayout from '@/layouts/MainLayout.astro';
import { companies } from '@/data/companies';

const pageTitle = "Company Funding Database - Latest Funding Rounds | Tying.ai";
const pageDescription = "Browse the latest company funding rounds, investments, and startup news. Track Series A, B, C rounds and seed funding across tech companies.";
---

<MainLayout title={pageTitle} description={pageDescription}>
  <div class="max-w-notion-wide mx-auto px-8 py-24">
    <!-- 页面标题 -->
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-notion-text mb-4">
        Company Funding Database
      </h1>
      <p class="text-lg text-notion-text-light">
        Browse the latest company funding rounds, investments, and startup news. Track {companies.length}+ companies with detailed funding information.
      </p>
    </div>

    <!-- 搜索框 -->
    <div class="mb-8">
      <input
        type="text"
        id="searchInput"
        placeholder="Search companies, investors, or rounds..."
        class="w-full px-4 py-3 border border-notion-border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        aria-label="Search companies"
      />
    </div>

    <!-- 公司表格 -->
    <div class="overflow-x-auto rounded-lg shadow-sm border border-notion-border">
      <table class="w-full border-collapse bg-white text-sm" id="companyTable">
        <thead class="bg-notion-gray-10 sticky top-0 z-10">
          <tr>
            <th class="px-4 py-3 text-left font-semibold text-notion-text border-b-2 border-notion-border whitespace-nowrap">Company</th>
            <th class="px-4 py-3 text-left font-semibold text-notion-text border-b-2 border-notion-border whitespace-nowrap">Round</th>
            <th class="px-4 py-3 text-left font-semibold text-notion-text border-b-2 border-notion-border whitespace-nowrap">Date</th>
            <th class="px-4 py-3 text-left font-semibold text-notion-text border-b-2 border-notion-border whitespace-nowrap">Lead Investor</th>
            <th class="px-4 py-3 text-left font-semibold text-notion-text border-b-2 border-notion-border whitespace-nowrap">Homepage</th>
            <th class="px-4 py-3 text-left font-semibold text-notion-text border-b-2 border-notion-border whitespace-nowrap">Jobs Page</th>
            <th class="px-4 py-3 text-left font-semibold text-notion-text border-b-2 border-notion-border whitespace-nowrap">News</th>
          </tr>
        </thead>
        <tbody>
          {companies.map((company) => (
            <tr class="border-b border-notion-border hover:bg-notion-gray-10 transition-colors">
              <td class="px-4 py-3 font-semibold text-notion-text whitespace-nowrap">{company.name}</td>
              <td class="px-4 py-3">
                <span class="inline-block px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs font-medium whitespace-nowrap">
                  {company.round}
                </span>
              </td>
              <td class="px-4 py-3 text-notion-text-light">{company.date}</td>
              <td class="px-4 py-3 text-notion-text-light">{company.leadInvestor}</td>
              <td class="px-4 py-3">
                <a
                  href={company.website}
                  target="_blank"
                  rel="noopener"
                  class="text-blue-600 hover:text-blue-700 hover:underline"
                >
                  Website
                </a>
              </td>
              <td class="px-4 py-3">
                <a
                  href={company.jobs}
                  target="_blank"
                  rel="noopener"
                  class="text-blue-600 hover:text-blue-700 hover:underline"
                >
                  Jobs
                </a>
              </td>
              <td class="px-4 py-3">
                <a
                  href={company.news}
                  target="_blank"
                  rel="noopener"
                  class="text-blue-600 hover:text-blue-700 hover:underline"
                >
                  News
                </a>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  </div>
</MainLayout>

<!-- 搜索功能脚本 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput') as HTMLInputElement;
    const table = document.getElementById('companyTable') as HTMLTableElement;
    const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');

    if (searchInput) {
      searchInput.addEventListener('keyup', function() {
        const searchTerm = this.value.toLowerCase();

        Array.from(rows).forEach(function(row) {
          const text = row.textContent?.toLowerCase() || '';
          (row as HTMLElement).style.display = text.includes(searchTerm) ? '' : 'none';
        });
      });
    }
  });
</script>
